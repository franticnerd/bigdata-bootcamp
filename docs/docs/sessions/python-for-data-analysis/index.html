<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="1. Python Installation: Anaconda If you don&rsquo;t feel like using the local environment, you can try Google Colab for a free online python environment. The examples are also available on Colab:
Ignore this session if you already have a python environment.
Anaconda is a complete, open source data science package with a community of over 6 million users. It is easy to download and install; and it supports Linux, macOS, and Windows (source)."><meta property="og:title" content="Python Tools for Data Analysis" />
<meta property="og:description" content="1. Python Installation: Anaconda If you don&rsquo;t feel like using the local environment, you can try Google Colab for a free online python environment. The examples are also available on Colab:
Ignore this session if you already have a python environment.
Anaconda is a complete, open source data science package with a community of over 6 million users. It is easy to download and install; and it supports Linux, macOS, and Windows (source)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://franticnerd/bigdata-bootcamp/docs/sessions/python-for-data-analysis/" /><meta property="article:section" content="docs" />
<meta property="article:published_time" content="2022-02-26T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-02-26T00:00:00+00:00" />

<title>Python Tools for Data Analysis | GT Big Data Bootcamp</title>
<link rel="icon" href="/bigdata-bootcamp/favicon.png" type="image/x-icon">


<link rel="stylesheet" href="/bigdata-bootcamp/book.min.43ea4026a52be03f709fccca49769e06471f235a1fc425b2a481cc2c3ea0a7d2.css" integrity="sha256-Q&#43;pAJqUr4D9wn8zKSXaeBkcfI1ofxCWypIHMLD6gp9I=">


<script defer src="/bigdata-bootcamp/en.search.min.12e117d1d6a57d2791ab8f84a11f9fa5b3c5bc1ac819af94af1e0ba29292be53.js" integrity="sha256-EuEX0dalfSeRq4&#43;EoR&#43;fpbPFvBrIGa&#43;Urx4LopKSvlM="></script>

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/bigdata-bootcamp"><span>GT Big Data Bootcamp</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  

  
  





 
  
    




  
  <ul>
    
      
        

  <li class="book-section-flat" >
    

  
  <span>Environment</span>
  


    




  
  <ul>
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-local-docker/" class="">Docker in Local OS</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-local-docker-linux/" class="">Install Docker in Linux</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-local-docker-macos/" class="">Install Docker in macOS</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-local-docker-windows/" class="">Install Docker in Mircosoft Windows</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-azure-docker/" class="">Env Azure Docker</a>
  

</li>
      
    
  </ul>
  



  </li>


      
    
      
        

  <li class="book-section-flat" >
    

  
  <span>Sessions</span>
  


    




  
  <ul>
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/python-for-data-analysis/" class="active">Python Tools for Data Analysis</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/scala-basic/" class="">Scala Basic</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/scala-intro/" class="">Scala Intro</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-application/" class="">Spark Application</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-basic/" class="">Spark Basic</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-graphx/" class="">Spark Graphx</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-mllib/" class="">Spark Mllib</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-sql/" class="">Spark SQL</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/zeppelin-intro/" class="">Zeppelin Intro</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/zeppelin-tutorial/" class="">Zeppelin Tutorial</a>
  

</li>
      
    
  </ul>
  



  </li>


      
    
  </ul>
  



  
















</nav>




  <script>(function(){var e=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/bigdata-bootcamp/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Python Tools for Data Analysis</strong>

  <label for="toc-control">
    <img src="/bigdata-bootcamp/svg/toc.svg" class="book-icon" alt="Table of Contents" />
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#1-python-installation-anaconda">1. Python Installation: Anaconda</a>
      <ul>
        <li><a href="#11-windows-and-macos">1.1. Windows and macOS</a></li>
        <li><a href="#12-linux-with-terminal">1.2. Linux with terminal</a></li>
        <li><a href="#13-verify-your-installation">1.3. Verify your installation</a></li>
        <li><a href="#14-conda-environment">1.4. Conda environment</a></li>
      </ul>
    </li>
    <li><a href="#2-package-installation">2. Package Installation</a></li>
    <li><a href="#3-basic-python-concepts">3. Basic Python Concepts</a>
      <ul>
        <li><a href="#31-variable-definition-input-and-output-print">3.1. Variable definition, input and output (print)</a></li>
        <li><a href="#32-list-tuple-set-and-dictionary">3.2. List, tuple, set and dictionary</a></li>
        <li><a href="#33-if-else">3.3. If else</a></li>
        <li><a href="#34-loops">3.4. Loops</a></li>
        <li><a href="#35-function">3.5 Function</a></li>
      </ul>
    </li>
    <li><a href="#4-basic-numpy-usage">4. Basic Numpy Usage</a>
      <ul>
        <li><a href="#41-array-creation">4.1. Array creation</a></li>
        <li><a href="#42-array-indexing">4.2. Array indexing</a></li>
        <li><a href="#43-array-math">4.3. Array math</a></li>
      </ul>
    </li>
    <li><a href="#5-using-matplotlib-for-visualization">5. Using Matplotlib for visualization</a></li>
    <li><a href="#6-pandas-and-scikit-learn-for-data-science">6. Pandas and Scikit-Learn for Data Science</a>
      <ul>
        <li><a href="#61-import-packages">6.1. Import packages</a></li>
        <li><a href="#62-load-data">6.2. Load data</a></li>
        <li><a href="#63-take-a-look-of-the-loaded-data">6.3. Take a look of the loaded data</a></li>
        <li><a href="#64-split-data">6.4. Split data</a></li>
        <li><a href="#65-pre-processing">6.5. Pre-processing</a></li>
        <li><a href="#66-fit-the-model">6.6. Fit the model</a></li>
        <li><a href="#67-define-the-cross-validation-pipeline">6.7. Define the cross-validation pipeline</a></li>
        <li><a href="#68-save-and-load-models">6.8. Save and load models</a></li>
      </ul>
    </li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      
      
  <article class="markdown"><h2 id="1-python-installation-anaconda">1. Python Installation: Anaconda</h2>
<blockquote>
<p><strong>If you don&rsquo;t feel like using the local environment</strong>, you can try <a href="https://colab.research.google.com/">Google Colab</a> for a <em>free</em> online python environment.
The examples are also available on Colab:<br>
<a href="https://colab.research.google.com/drive/1J2rCfbQm5heCt5LN1t8RZHA1O9VaT8b-?usp=sharing"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open in Colab" /></a></p>
</blockquote>
<p><strong>Ignore this session if you already have a python environment.</strong></p>
<p><a href="https://www.anaconda.com/">Anaconda</a> is a complete, <a href="https://docs.anaconda.com/anaconda/eula">open source</a> data science package with a community of over 6 million users.
It is easy to <a href="https://www.anaconda.com/download/">download</a> and install;
and it supports Linux, macOS, and Windows (<a href="https://opensource.com/article/18/4/getting-started-anaconda-python">source</a>).</p>
<p>In this tutorial, we&rsquo;ll use <a href="https://docs.conda.io/en/latest/miniconda.html">Miniconda</a> for minimal installation.
Please refer to <a href="https://conda.io/projects/conda/en/latest/user-guide/install/download.html#anaconda-or-miniconda">this page</a> for the difference between Anaconda and Miniconda and which one to choose.</p>
<h3 id="11-windows-and-macos">1.1. Windows and macOS</h3>
<ol>
<li>Download the latest Miniconda installer (with Python 3.9) from the <a href="https://docs.conda.io/en/latest/miniconda.html#windows-installers">official website</a>.</li>
<li>Install the package according to the instructions.</li>
<li>Start to use <em>conda</em> environment with <em>Anaconda Prompt</em> or other shells if you enabled this feature during installation.</li>
</ol>
<blockquote>
<p>Notice: To use <code>conda</code> command in other shells/prompts, you need to add the conda directory to your <code>PATH</code> environment variable.</p>
</blockquote>
<blockquote>
<p>Reference: [<a href="https://docs.anaconda.com/anaconda/install/windows/">1</a>, <a href="https://docs.anaconda.com/anaconda/install/mac-os/">2</a>].</p>
</blockquote>
<h3 id="12-linux-with-terminal">1.2. Linux with terminal</h3>
<ol>
<li>Start the terminal.</li>
<li>Switch to <code>~/Download/</code> with command <code>cd ~/Download/</code>. If the path does not exist, create one using <code>mkdir ~/Download/</code>.</li>
<li>Download the latest Linux Miniconda distribution using <code>wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh</code>.</li>
<li>Once download is complete, install Miniconda using <code>bash Miniconda3-latest-Linux-x86_64.sh</code>.</li>
<li>Follow the prompts on the installer screens.
If you are unsure about any setting, accept the defaults. You can change them later.</li>
<li>To make the changes take effect, close and then re-open your terminal window or use the command <code>source ~/.bashrc</code>.</li>
<li>If you are using <em>zsh</em> or other shells, make sure conda is initiated. To do this, switch back to bash and type the command <code>conda init &lt;shell name&gt;</code>.</li>
</ol>
<blockquote>
<p>Reference: [<a href="https://docs.anaconda.com/anaconda/install/linux/">1</a>].</p>
</blockquote>
<h3 id="13-verify-your-installation">1.3. Verify your installation</h3>
<p>You can use the command <code>conda list</code> to check your conda installation.
If the terminal returns a bunch of python packages, then your installation is successful.</p>
<blockquote>
<p>Reference: [<a href="https://docs.anaconda.com/anaconda/install/verify-install/">1</a>].</p>
</blockquote>
<h3 id="14-conda-environment">1.4. Conda environment</h3>
<p>With conda, you can create, remove, and update environments, each with an independent version of Python interpreter and Python packages.
Switching or moving between environments is called activating the environment.</p>
<p>This part is not necessary as you can directly <em>base</em> environment, which is the default conda environment.
For those who want to know more, please refer to <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html">conda: managing environments</a> for details and instructions.</p>
<h2 id="2-package-installation">2. Package Installation</h2>
<p>If you are using Anaconda or Miniconda, you can use the Anaconda package manager <code>conda</code>.
You can also use other managers such as <code>pip</code> when the packages are not provided by any conda sources.
However, in this tutorial, we&rsquo;ll only cover how to install packages with <code>conda</code> instructions.</p>
<p>To look for a specific package, you can visit <a href="https://anaconda.org/">this website</a> and type the name of that package in the search box.
For today&rsquo;s instruction, we need to install <code>numpy</code>, <code>matplotlib</code>,  <code>scikit-learn</code> and <code>pandas</code>.</p>
<p>First, switch to your conda environment using <code>conda activate &lt;env name&gt;</code> (not necessary if you are using the default <em>base</em> environment), then install those packages by executing these instructions:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>conda install -c conda-forge numpy
</span></span><span style="display:flex;"><span>conda install -c conda-forge matplotlib
</span></span><span style="display:flex;"><span>conda install -c conda-forge scikit-learn
</span></span><span style="display:flex;"><span>conda install -c conda-forge pandas
</span></span></code></pre></div><p>The package manager will automatically install all dependencies.
So if you choose to install scikit-learn first, then you don&rsquo;t have to install numpy manually as scikit-learn depends on numpy.</p>
<p>If you prefer a fancier and more powerful python shell, you can choose to install <code>ipython</code> and even <code>jupyter notebook</code>, which allows you to run your commands in your browser.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>conda install -c conda-forge ipython
</span></span><span style="display:flex;"><span>conda install jupyter
</span></span></code></pre></div><h2 id="3-basic-python-concepts">3. Basic Python Concepts</h2>
<blockquote>
<p>A more comprehensive tutorial can be found at the <a href="http://cs231n.github.io/python-numpy-tutorial/#python-basic">Stanford CS231n website</a>.
In this and the following sections, we&rsquo;ll introduce the basic concepts due to time limitations.</p>
</blockquote>
<p><a href="https://colab.research.google.com/drive/1J2rCfbQm5heCt5LN1t8RZHA1O9VaT8b-?usp=sharing"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open in Colab" /></a></p>
<p>We use <strong>Python 3.9</strong> in this tutorial.</p>
<blockquote>
<p>Notice that previous Python interpreter versions may behave differently.
Please refer to the <a href="https://docs.python.org/dev/whatsnew/index.html">official document</a> for more details.</p>
</blockquote>
<p>First, in your terminal, type <code>python</code> or <code>ipython</code> or <code>jupyter notebook</code> to start an interactive python shell.
<code>ipython</code> or <code>jupyter notebook</code> is recommended.</p>
<h3 id="31-variable-definition-input-and-output-print">3.1. Variable definition, input and output (print)</h3>
<p>There&rsquo;s no type constraint for a variable, i.e., a variable can be of any type.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>a <span style="color:#f92672">=</span> <span style="color:#ae81ff">123</span>
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;123&#39;</span>
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1234&#34;</span>
</span></span><span style="display:flex;"><span>print(a, b, c, type(a), type(b), type(c))
</span></span></code></pre></div><p>A variable can be overwritten by different types</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>a <span style="color:#f92672">=</span> <span style="color:#ae81ff">123.456</span>
</span></span><span style="display:flex;"><span>print(type(a))
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;123&#39;</span>
</span></span><span style="display:flex;"><span>print(type(a))
</span></span></code></pre></div><p>Input some strings interactively:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>x <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#39;Input something: &#39;</span>)
</span></span><span style="display:flex;"><span>print(x, type(x))
</span></span></code></pre></div><blockquote>
<p>Notice that this input method is rarely used in big data scenarios.
A more practical input method is <a href="https://docs.python.org/3/library/argparse.html">argparse</a>.</p>
</blockquote>
<h3 id="32-list-tuple-set-and-dictionary">3.2. List, tuple, set and dictionary</h3>
<ul>
<li><strong>List</strong> is a collection that is <em>ordered</em> and <em>changeable</em>.
It allows duplicate members.</li>
<li><strong>Tuple</strong> is a collection which is <em>ordered</em> but <em>not changeable</em>.
It also allows duplicate members.</li>
<li><strong>Set</strong> is a collection which is <em>unordered</em> and <em>unindexed</em>.
It does not allow duplicate members.
Elements in a set cannot be retrieved by index.</li>
<li><strong>Dictionary</strong> is a collection which is <em>ordered</em>, <em>changeable</em> and <em>indexed</em>.
It does not allow duplicate members.</li>
</ul>
<blockquote>
<p>Notice that Dictionary used to be unordered before Python 3.7.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>_list <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1.2</span>, <span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">&#39;2&#39;</span>, <span style="color:#ae81ff">1</span>]  <span style="color:#75715e"># this is a list</span>
</span></span><span style="display:flex;"><span>_tuple <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1.2</span>, <span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">&#39;2&#39;</span>, <span style="color:#ae81ff">1</span>)  <span style="color:#75715e"># this is a tuple</span>
</span></span><span style="display:flex;"><span>_set <span style="color:#f92672">=</span> {<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1.2</span>, <span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">&#39;2&#39;</span>, <span style="color:#ae81ff">1</span>}  <span style="color:#75715e"># this is a set</span>
</span></span><span style="display:flex;"><span>_dict <span style="color:#f92672">=</span> {  <span style="color:#75715e"># this is a dict</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">1</span>: <span style="color:#e6db74">&#39;111&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">2</span>: <span style="color:#e6db74">&#39;222&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;1&#39;</span>: <span style="color:#ae81ff">567</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">2.2</span>: [<span style="color:#e6db74">&#39;J&#39;</span>, <span style="color:#e6db74">&#39;Q&#39;</span>, <span style="color:#e6db74">&#39;K&#39;</span>]
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>print(_list, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, _tuple, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, _set, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, _dict)
</span></span></code></pre></div><p>Access elements</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(_list[<span style="color:#ae81ff">0</span>], _list[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>], _list[<span style="color:#ae81ff">1</span>: <span style="color:#ae81ff">3</span>])
</span></span><span style="display:flex;"><span>print(_tuple[<span style="color:#ae81ff">1</span>], _tuple[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>print(_set[<span style="color:#ae81ff">0</span>], _set[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>print(_dict[<span style="color:#ae81ff">1</span>], _dict[<span style="color:#e6db74">&#39;1&#39;</span>], _dict[<span style="color:#ae81ff">2.2</span>])
</span></span></code></pre></div><p>Shallow copy</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>a <span style="color:#f92672">=</span> _list
</span></span><span style="display:flex;"><span>a[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">888</span>
</span></span><span style="display:flex;"><span>print(a, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, _list)
</span></span></code></pre></div><h3 id="33-if-else">3.3. If else</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#ae81ff">888</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> _dict<span style="color:#f92672">.</span>keys():
</span></span><span style="display:flex;"><span>    _dict[<span style="color:#ae81ff">888</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;???&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">elif</span> <span style="color:#ae81ff">999</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> _dict<span style="color:#f92672">.</span>keys():
</span></span><span style="display:flex;"><span>    _dict[<span style="color:#ae81ff">999</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;!@#$%&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>    _dict[<span style="color:#e6db74">&#39;qwert&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;poiuy&#39;</span>
</span></span></code></pre></div><h3 id="34-loops">3.4. Loops</h3>
<p><code>for</code> loop:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> _list:
</span></span><span style="display:flex;"><span>    print(x)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(_list)):
</span></span><span style="display:flex;"><span>    print(_list[i])
</span></span></code></pre></div><p><code>while</code> loop:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> i <span style="color:#f92672">!=</span> len(_list):
</span></span><span style="display:flex;"><span>    print(_list[i])
</span></span><span style="display:flex;"><span>    i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span></code></pre></div><h3 id="35-function">3.5 Function</h3>
<p>Define a function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_func</span>(x):
</span></span><span style="display:flex;"><span>	x <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;in function: &#39;</span>, x)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> x
</span></span></code></pre></div><p>Call a function</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>t <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>tt <span style="color:#f92672">=</span> my_func(t)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;out of funciton, t: </span><span style="color:#e6db74">{</span>t<span style="color:#e6db74">}</span><span style="color:#e6db74">, tt: </span><span style="color:#e6db74">{</span>tt<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span></code></pre></div><h2 id="4-basic-numpy-usage">4. Basic Numpy Usage</h2>
<h3 id="41-array-creation">4.1. Array creation</h3>
<p>A numpy array is a grid of values, all of the same type, and is indexed by a tuple of nonnegative integers.
The number of dimensions is the <em>rank</em> of the array; the <em>shape</em> of an array is a tuple of integers giving the size of the array along each dimension.</p>
<p>We can initialize numpy arrays from nested Python lists, and access elements using square brackets:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>])   <span style="color:#75715e"># Create a rank 1 array</span>
</span></span><span style="display:flex;"><span>print(type(a), a<span style="color:#f92672">.</span>dtype)
</span></span><span style="display:flex;"><span>print(a<span style="color:#f92672">.</span>shape)
</span></span><span style="display:flex;"><span>print(a[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>],[<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">6</span>]])    <span style="color:#75715e"># Create a rank 2 array</span>
</span></span><span style="display:flex;"><span>print(b<span style="color:#f92672">.</span>shape)
</span></span><span style="display:flex;"><span>print(b[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], b[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>], b[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>])
</span></span></code></pre></div><p>Change the type of an array:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(a<span style="color:#f92672">.</span>dtype)
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> a<span style="color:#f92672">.</span>astype(float)
</span></span><span style="display:flex;"><span>print(a<span style="color:#f92672">.</span>dtype)
</span></span></code></pre></div><p>Other array creation methods:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>a <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>zeros((<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">2</span>))   <span style="color:#75715e"># Create an array of all zeros</span>
</span></span><span style="display:flex;"><span>print(a)
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>ones((<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>))    <span style="color:#75715e"># Create an array of all ones</span>
</span></span><span style="display:flex;"><span>print(b)
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>full((<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">2</span>), <span style="color:#ae81ff">7</span>, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float32)  <span style="color:#75715e"># Create a constant array</span>
</span></span><span style="display:flex;"><span>print(c)
</span></span><span style="display:flex;"><span>d <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>eye(<span style="color:#ae81ff">3</span>)         <span style="color:#75715e"># Create a 3x3 identity matrix</span>
</span></span><span style="display:flex;"><span>print(d)
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>random((<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">3</span>))  <span style="color:#75715e"># Create an array filled with random values</span>
</span></span><span style="display:flex;"><span>print(e)
</span></span></code></pre></div><h3 id="42-array-indexing">4.2. Array indexing</h3>
<p>Similar to Python lists, numpy arrays can be sliced. Since arrays may be multidimensional, you must specify a slice for each dimension of the array:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Create a rank 1 array and reshape it to a 3x4 matrix</span>
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">12</span>)<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> a[:<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">3</span>]
</span></span><span style="display:flex;"><span>print(a)
</span></span><span style="display:flex;"><span>print(b)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Shallow copy</span>
</span></span><span style="display:flex;"><span>b[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">888</span>
</span></span><span style="display:flex;"><span>print(a)
</span></span></code></pre></div><p>You can mix integer indexing with slice indexing. However, integer indexing will yield an array of lower rank than the original array:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>row_r1 <span style="color:#f92672">=</span> a[<span style="color:#ae81ff">1</span>, :]    <span style="color:#75715e"># Rank 1 view of the second row of a</span>
</span></span><span style="display:flex;"><span>row_r2 <span style="color:#f92672">=</span> a[<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">2</span>, :]  <span style="color:#75715e"># Rank 2 view of the second row of a</span>
</span></span><span style="display:flex;"><span>print(row_r1, row_r1<span style="color:#f92672">.</span>shape)
</span></span><span style="display:flex;"><span>print(row_r2, row_r2<span style="color:#f92672">.</span>shape)
</span></span></code></pre></div><p>You can also access element in the array through lists:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>x <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>print(a[x, y])
</span></span></code></pre></div><p>Or through a boolean array:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>b <span style="color:#f92672">=</span> a <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>print(b)
</span></span><span style="display:flex;"><span>print(a[b])
</span></span></code></pre></div><h3 id="43-array-math">4.3. Array math</h3>
<p>Basic mathematical functions operate element-wise on arrays, and are available both as operator overloads and as functions in the numpy module:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float)<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">9</span>, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float)<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>print(x)
</span></span><span style="display:flex;"><span>print(y)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Elementwise sum</span>
</span></span><span style="display:flex;"><span>print(x <span style="color:#f92672">+</span> y)
</span></span><span style="display:flex;"><span>print(np<span style="color:#f92672">.</span>add(x, y))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Elementwise difference</span>
</span></span><span style="display:flex;"><span>print(x <span style="color:#f92672">-</span> y)
</span></span><span style="display:flex;"><span>print(np<span style="color:#f92672">.</span>subtract(x, y))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Elementwise product</span>
</span></span><span style="display:flex;"><span>print(x <span style="color:#f92672">*</span> y)
</span></span><span style="display:flex;"><span>print(np<span style="color:#f92672">.</span>multiply(x, y))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Elementwise division</span>
</span></span><span style="display:flex;"><span>print(x <span style="color:#f92672">/</span> y)
</span></span><span style="display:flex;"><span>print(np<span style="color:#f92672">.</span>divide(x, y))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Elementwise square</span>
</span></span><span style="display:flex;"><span>print(x <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>print(np<span style="color:#f92672">.</span>power(x, <span style="color:#ae81ff">2</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Elementwise square root</span>
</span></span><span style="display:flex;"><span>print(x <span style="color:#f92672">**</span> <span style="color:#ae81ff">0.5</span>)
</span></span><span style="display:flex;"><span>print(np<span style="color:#f92672">.</span>sqrt(x))
</span></span></code></pre></div><p>Matrix multiplication</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float)<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">9</span>, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float)<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>print(x)
</span></span><span style="display:flex;"><span>print(y)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>v <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>], dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float)
</span></span><span style="display:flex;"><span>w <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>], dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Inner product</span>
</span></span><span style="display:flex;"><span>print(v<span style="color:#f92672">.</span>dot(w))
</span></span><span style="display:flex;"><span>print(np<span style="color:#f92672">.</span>dot(v, w))
</span></span><span style="display:flex;"><span>print(v <span style="color:#f92672">@</span> w)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Matrix / vector product</span>
</span></span><span style="display:flex;"><span>print(x<span style="color:#f92672">.</span>dot(v))
</span></span><span style="display:flex;"><span>print(np<span style="color:#f92672">.</span>dot(x, v))
</span></span><span style="display:flex;"><span>print(x <span style="color:#f92672">@</span> v)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Matrix / matrix product</span>
</span></span><span style="display:flex;"><span>print(x<span style="color:#f92672">.</span>dot(y))
</span></span><span style="display:flex;"><span>print(np<span style="color:#f92672">.</span>dot(x, y))
</span></span><span style="display:flex;"><span>print(x <span style="color:#f92672">@</span> y)
</span></span></code></pre></div><p><strong>Attention:</strong> <code>np.dot()</code> and <code>@</code> behaves differently when the matrix rank is greater than 2.</p>
<p>Numpy provides many useful functions for performing computations on arrays such as  <code>sum</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(np<span style="color:#f92672">.</span>sum(x))  <span style="color:#75715e"># Compute sum of all elements; prints &#34;10&#34;</span>
</span></span><span style="display:flex;"><span>print(x<span style="color:#f92672">.</span>sum())  <span style="color:#75715e"># same as above</span>
</span></span><span style="display:flex;"><span>print(np<span style="color:#f92672">.</span>sum(x, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>))  <span style="color:#75715e"># Compute sum of each column; prints &#34;[4 6]&#34;</span>
</span></span><span style="display:flex;"><span>print(np<span style="color:#f92672">.</span>sum(x, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>))  <span style="color:#75715e"># Compute sum of each row; prints &#34;[3 7]&#34;</span>
</span></span></code></pre></div><p>To transpose a matrix, use the <code>T</code> attribute of an array object:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(x<span style="color:#f92672">.</span>T)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Note that taking the transpose of a rank one array does nothing:</span>
</span></span><span style="display:flex;"><span>print(v)
</span></span><span style="display:flex;"><span>print(v<span style="color:#f92672">.</span>T)
</span></span></code></pre></div><h2 id="5-using-matplotlib-for-visualization">5. Using Matplotlib for visualization</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#75715e"># %matplotlib qt</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Compute the x and y coordinates for points on a sine curve</span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>pi, <span style="color:#ae81ff">0.1</span>)
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sin(x)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Plot the points using matplotlib</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x, y)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()  <span style="color:#75715e"># You must call plt.show() to make graphics appear.</span>
</span></span></code></pre></div><blockquote>
<p>Note: for jupyter notebook, you can use the command <code>%matplotlib inline</code> to make the graphics embedded in the editor or <code>%matplotlib qt</code> to make them pop out.</p>
</blockquote>
<p>To plot multiple lines at once, and add a title, legend, and axis labels:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>pi, <span style="color:#ae81ff">0.1</span>)
</span></span><span style="display:flex;"><span>y_sin <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sin(x)
</span></span><span style="display:flex;"><span>y_cos <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>cos(x)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Plot the points using matplotlib</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x, y_sin)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x, y_cos)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;x axis label&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;y axis label&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Sine and Cosine&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend([<span style="color:#e6db74">&#39;Sine&#39;</span>, <span style="color:#e6db74">&#39;Cosine&#39;</span>])
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p>You can plot different things in the same figure using the <code>subplot</code> function. Here is an example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Set up a subplot grid that has height 2 and width 1,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># and set the first such subplot as active.</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Make the first plot</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x, y_sin)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Sine&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Set the second subplot as active, and make the second plot.</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(x, y_cos)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Cosine&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Show the figure.</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><h2 id="6-pandas-and-scikit-learn-for-data-science">6. Pandas and Scikit-Learn for Data Science</h2>
<p>In this section, we will look at a data science example using pandas as data management tool and scikit-learn (sklearn) as algorithm implementation.
This section is modified from <a href="https://elitedatascience.com/python-machine-learning-tutorial-scikit-learn">this tutorial</a>.</p>
<h3 id="61-import-packages">6.1. Import packages</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># automatically split the data into training and test set</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn <span style="color:#f92672">import</span> preprocessing
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># classifiers and regressors</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.ensemble <span style="color:#f92672">import</span> RandomForestRegressor
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Construct a Pipeline from the given estimators</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.pipeline <span style="color:#f92672">import</span> make_pipeline
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Exhaustive search over specified parameter values for an estimator.</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> GridSearchCV
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Training objective and evaluation metrics</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> mean_squared_error, r2_score
</span></span><span style="display:flex;"><span><span style="color:#75715e"># For model persistence</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># you can use `from sklearn.externals import joblib` if your sklearn version is earlier than 0.23</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> joblib
</span></span></code></pre></div><h3 id="62-load-data">6.2. Load data</h3>
<p>You can download the <a href="https://archive.ics.uci.edu/ml/machine-learning-databases/wine-quality/winequality-red.csv">data</a> by clicking the link or using <code>wget</code>: <code>wget https://archive.ics.uci.edu/ml/machine-learning-databases/wine-quality/winequality-red.csv</code> and move the file to your current folder.
Then, load the <code>csv</code> data into memory through <code>pandas</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;winequality-red.csv&#39;</span>, sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;;&#39;</span>)
</span></span></code></pre></div><p>Or, you can directly load the data through URL.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>dataset_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://archive.ics.uci.edu/ml/machine-learning-databases/wine-quality/winequality-red.csv&#39;</span>
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(dataset_url, sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;;&#39;</span>)
</span></span></code></pre></div><p>You can also load datasets stored in other formats with <code>pandas</code>.
A detailed document is at <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html">pandas: io</a>.</p>
<h3 id="63-take-a-look-of-the-loaded-data">6.3. Take a look of the loaded data</h3>
<p>The data loaded is stored in the type of <code>pandas.core.frame.DataFrame</code></p>
<p>To give a peak of the data, we can use</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(data)
</span></span></code></pre></div><p>This will return a nice-looking preview of the elements in the DataFrame.</p>
<p>To view the name of the features of a DataFrame, one can use</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(data<span style="color:#f92672">.</span>keys())
</span></span></code></pre></div><p>To access one column, i.e., all instances of a feature, e.g., <code>pH</code>, one can use</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># These will return the same result</span>
</span></span><span style="display:flex;"><span>print(data[<span style="color:#e6db74">&#39;pH&#39;</span>])
</span></span><span style="display:flex;"><span>print(data<span style="color:#f92672">.</span>pH)
</span></span></code></pre></div><p>To access a row, you need the <code>DataFrame.iloc</code> attribute:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(data<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">10</span>])
</span></span></code></pre></div><p>We can also easily print some summary statistics:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(data<span style="color:#f92672">.</span>describe())
</span></span></code></pre></div><h3 id="64-split-data">6.4. Split data</h3>
<p>First, let&rsquo;s separate our target (y) feature from our input (X) features and divide the dataset into training and test sets using the <code>train_test_split</code> function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>y <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>quality
</span></span><span style="display:flex;"><span>X <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>drop(<span style="color:#e6db74">&#39;quality&#39;</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(
</span></span><span style="display:flex;"><span>    X, y, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, stratify<span style="color:#f92672">=</span>y
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>Stratify your sample by the target variable will ensure your training set looks similar to your test set, making your evaluation metrics more reliable.</p>
<h3 id="65-pre-processing">6.5. Pre-processing</h3>
<p>Standardization is the process of subtracting the means from each feature and then dividing by the feature standard deviations. It is a common requirement for machine learning tasks. Many algorithms assume that all features are centered around zero and have approximately the same variance.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>scaler <span style="color:#f92672">=</span> preprocessing<span style="color:#f92672">.</span>StandardScaler()<span style="color:#f92672">.</span>fit(X_train)
</span></span><span style="display:flex;"><span>X_train_scaled <span style="color:#f92672">=</span> scaler<span style="color:#f92672">.</span>transform(X_train)
</span></span><span style="display:flex;"><span>X_test_scaled <span style="color:#f92672">=</span> scaler<span style="color:#f92672">.</span>transform(X_test)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># To prove the trainig and testing sets have (nearly) zero mean and one deviation</span>
</span></span><span style="display:flex;"><span>print(X_train_scaled<span style="color:#f92672">.</span>mean(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>))
</span></span><span style="display:flex;"><span>print(X_train_scaled<span style="color:#f92672">.</span>std(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>))
</span></span><span style="display:flex;"><span>print(X_test_scaled<span style="color:#f92672">.</span>mean(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>))
</span></span><span style="display:flex;"><span>print(X_test_scaled<span style="color:#f92672">.</span>std(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>))
</span></span></code></pre></div><h3 id="66-fit-the-model">6.6. Fit the model</h3>
<p>If we do not need to fine-tune the hyperparameters, we can define a random forest regression model with the default hyperparameters and fit the model using</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>regr <span style="color:#f92672">=</span> RandomForestRegressor()
</span></span><span style="display:flex;"><span>regr<span style="color:#f92672">.</span>fit(X_train_scaled, y_train)
</span></span></code></pre></div><p>To examine the performance, we use the test set to calculate the scores</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pred <span style="color:#f92672">=</span> regr<span style="color:#f92672">.</span>predict(X_test_scaled)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(r2_score(y_test, pred))
</span></span><span style="display:flex;"><span>print(mean_squared_error(y_test, pred))
</span></span></code></pre></div><h3 id="67-define-the-cross-validation-pipeline">6.7. Define the cross-validation pipeline</h3>
<p>Fine-tuning hyperparameters is an important job in Machine Learning since a set of carefully chosen hyperparameters may greatly improve the performance of the model.</p>
<p>In practice, when we set up the cross-validation pipeline, we won&rsquo;t even need to manually fit the data. Instead, we&rsquo;ll simply declare the class object, like so:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pipeline <span style="color:#f92672">=</span> make_pipeline(
</span></span><span style="display:flex;"><span>    preprocessing<span style="color:#f92672">.</span>StandardScaler(),
</span></span><span style="display:flex;"><span>    RandomForestRegressor(n_estimators<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>To check the hyperparameters, we may use</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print pipeline<span style="color:#f92672">.</span>get_params()
</span></span></code></pre></div><p>or refer to the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html">official document</a>.</p>
<p>Now, let&rsquo;s declare the hyperparameters we want to tune through cross-validation.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>hyperparameters <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;randomforestregressor__max_features&#39;</span> : [<span style="color:#e6db74">&#39;auto&#39;</span>, <span style="color:#e6db74">&#39;sqrt&#39;</span>, <span style="color:#e6db74">&#39;log2&#39;</span>],
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;randomforestregressor__max_depth&#39;</span>: [<span style="color:#66d9ef">None</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Then, we can set a 10-fold cross validation as simple as</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>clf <span style="color:#f92672">=</span> GridSearchCV(pipeline, hyperparameters, cv<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
</span></span></code></pre></div><p>Finally, we can automatically fine-tune the model using</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>clf<span style="color:#f92672">.</span>fit(X_train, y_train)
</span></span></code></pre></div><p>After the model fitting, if we want to check the best hyperparameters, we can use</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>print(clf<span style="color:#f92672">.</span>best_params_)
</span></span></code></pre></div><p>Same as before, we evaluate the fitted model on test set</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pred <span style="color:#f92672">=</span> clf<span style="color:#f92672">.</span>predict(X_test)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(r2_score(y_test, pred))
</span></span><span style="display:flex;"><span>print(mean_squared_error(y_test, pred))
</span></span></code></pre></div><h3 id="68-save-and-load-models">6.8. Save and load models</h3>
<p>After training, we may want to save the trained model for future use. For this purpose, we can use</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>joblib<span style="color:#f92672">.</span>dump(clf, <span style="color:#e6db74">&#39;rf_regressor.pkl&#39;</span>)
</span></span></code></pre></div><p>When you want to load the model again, simply use this function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>clf2 <span style="color:#f92672">=</span> joblib<span style="color:#f92672">.</span>load(<span style="color:#e6db74">&#39;rf_regressor.pkl&#39;</span>)
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Predict data set using loaded model</span>
</span></span><span style="display:flex;"><span>clf2<span style="color:#f92672">.</span>predict(X_test)
</span></span></code></pre></div><hr>
<p>A more comprehensive example of scikit-learn can be found <a href="https://scikit-learn.org/stable/tutorial/statistical_inference/index.html">here</a>.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex justify-between">





</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#1-python-installation-anaconda">1. Python Installation: Anaconda</a>
      <ul>
        <li><a href="#11-windows-and-macos">1.1. Windows and macOS</a></li>
        <li><a href="#12-linux-with-terminal">1.2. Linux with terminal</a></li>
        <li><a href="#13-verify-your-installation">1.3. Verify your installation</a></li>
        <li><a href="#14-conda-environment">1.4. Conda environment</a></li>
      </ul>
    </li>
    <li><a href="#2-package-installation">2. Package Installation</a></li>
    <li><a href="#3-basic-python-concepts">3. Basic Python Concepts</a>
      <ul>
        <li><a href="#31-variable-definition-input-and-output-print">3.1. Variable definition, input and output (print)</a></li>
        <li><a href="#32-list-tuple-set-and-dictionary">3.2. List, tuple, set and dictionary</a></li>
        <li><a href="#33-if-else">3.3. If else</a></li>
        <li><a href="#34-loops">3.4. Loops</a></li>
        <li><a href="#35-function">3.5 Function</a></li>
      </ul>
    </li>
    <li><a href="#4-basic-numpy-usage">4. Basic Numpy Usage</a>
      <ul>
        <li><a href="#41-array-creation">4.1. Array creation</a></li>
        <li><a href="#42-array-indexing">4.2. Array indexing</a></li>
        <li><a href="#43-array-math">4.3. Array math</a></li>
      </ul>
    </li>
    <li><a href="#5-using-matplotlib-for-visualization">5. Using Matplotlib for visualization</a></li>
    <li><a href="#6-pandas-and-scikit-learn-for-data-science">6. Pandas and Scikit-Learn for Data Science</a>
      <ul>
        <li><a href="#61-import-packages">6.1. Import packages</a></li>
        <li><a href="#62-load-data">6.2. Load data</a></li>
        <li><a href="#63-take-a-look-of-the-loaded-data">6.3. Take a look of the loaded data</a></li>
        <li><a href="#64-split-data">6.4. Split data</a></li>
        <li><a href="#65-pre-processing">6.5. Pre-processing</a></li>
        <li><a href="#66-fit-the-model">6.6. Fit the model</a></li>
        <li><a href="#67-define-the-cross-validation-pipeline">6.7. Define the cross-validation pipeline</a></li>
        <li><a href="#68-save-and-load-models">6.8. Save and load models</a></li>
      </ul>
    </li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












