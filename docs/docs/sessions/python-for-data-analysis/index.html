<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Python Tools for Data Analysis 1. Python Installation: Anaconda If you already have a python environment, ignore this session.
Anaconda is a complete, open source data science package with a community of over 6 million users. It is easy to download and install, and it is supported on Linux, MacOS, and Windows (source).
We&rsquo;ll use Miniconda for minimal installation.
Windows and macOS  Download the Python 3.7 distribution packages from this website."><meta property="og:title" content="" />
<meta property="og:description" content="Python Tools for Data Analysis 1. Python Installation: Anaconda If you already have a python environment, ignore this session.
Anaconda is a complete, open source data science package with a community of over 6 million users. It is easy to download and install, and it is supported on Linux, MacOS, and Windows (source).
We&rsquo;ll use Miniconda for minimal installation.
Windows and macOS  Download the Python 3.7 distribution packages from this website." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://franticnerd/bigdata-bootcamp/docs/sessions/python-for-data-analysis/" />

<title>Python for Data Analysis | GT Big Data Bootcamp</title>
<link rel="icon" href="/bigdata-bootcamp/favicon.png" type="image/x-icon">


<link rel="stylesheet" href="/bigdata-bootcamp/book.min.63eb88daa545365405ecdbb21033286a325c60a36cfa6d22d21e7c3bc9286941.css" integrity="sha256-Y&#43;uI2qVFNlQF7NuyEDMoajJcYKNs&#43;m0i0h58O8koaUE=">


<script defer src="/bigdata-bootcamp/en.search.min.7969ff8ebbcf762f23ab99ac5243cd65d7212f01b58f3324da0f9a9cf038c2bf.js" integrity="sha256-eWn/jrvPdi8jq5msUkPNZdchLwG1jzMk2g&#43;anPA4wr8="></script>

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/bigdata-bootcamp"><span>GT Big Data Bootcamp</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  

  
  





 
  
    




  
  <ul>
    
      
        

  <li class="book-section-flat" >
    

  
  <span>Environment</span>
  


    




  
  <ul>
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-azure-docker/" class="">Env Azure Docker</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-local-docker-linux/" class="">Env Local Docker Linux</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-local-docker-macos/" class="">Env Local Docker Macos</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-local-docker-windows/" class="">Env Local Docker Windows</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-local-docker/" class="">Env Local Docker</a>
  

</li>
      
    
  </ul>
  



  </li>


      
    
      
        

  <li class="book-section-flat" >
    

  
  <span>Sessions</span>
  


    




  
  <ul>
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/python-for-data-analysis/" class="active">Python for Data Analysis</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/scala-basic/" class="">Scala Basic</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/scala-intro/" class="">Scala Intro</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-application/" class="">Spark Application</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-basic/" class="">Spark Basic</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-graphx/" class="">Spark Graphx</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-mllib/" class="">Spark Mllib</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-sql/" class="">Spark Sql</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/zeppelin-intro/" class="">Zeppelin Intro</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/zeppelin-tutorial/" class="">Zeppelin Tutorial</a>
  

</li>
      
    
  </ul>
  



  </li>


      
    
  </ul>
  



  
















</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/bigdata-bootcamp/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Python for Data Analysis</strong>

  <label for="toc-control">
    <img src="/bigdata-bootcamp/svg/toc.svg" class="book-icon" alt="Table of Contents" />
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#1-python-installation-anaconda">1. Python Installation: Anaconda</a>
      <ul>
        <li><a href="#windows-and-macos">Windows and macOS</a></li>
        <li><a href="#linux-with--terminal">Linux with  terminal</a></li>
        <li><a href="#check-your-installation">Check your installation</a></li>
        <li><a href="#conda-environment">Conda environment</a></li>
      </ul>
    </li>
    <li><a href="#2-package-installation">2. Package Installation</a></li>
    <li><a href="#3-basic-python-concepts">3. Basic Python Concepts</a>
      <ul>
        <li><a href="#variable-definition-input-and-print">Variable definition, input and print</a></li>
        <li><a href="#list-tuple-set-and-dictionary">List, tuple, set and dictionary</a></li>
        <li><a href="#if-else">If else</a></li>
        <li><a href="#loops">Loops</a></li>
        <li><a href="#function">Function</a></li>
      </ul>
    </li>
    <li><a href="#4-basic-numpy-usage">4. Basic Numpy Usage</a>
      <ul>
        <li><a href="#array-creation">Array creation</a></li>
        <li><a href="#array-indexing">Array indexing</a></li>
        <li><a href="#array-math">Array math</a></li>
      </ul>
    </li>
    <li><a href="#5-using-matplotlib-for-visualization">5. Using Matplotlib for visualization</a></li>
    <li><a href="#6-pandas-and-scikit-learn-for-data-science">6. Pandas and Scikit-Learn for Data Science</a>
      <ul>
        <li><a href="#package-import">Package import</a></li>
        <li><a href="#load-data">Load data</a></li>
        <li><a href="#take-a-look-of-the-loaded-data">Take a look of the loaded data</a></li>
        <li><a href="#split-data">Split data</a></li>
        <li><a href="#pre-processing">Pre-processing</a></li>
        <li><a href="#fit-the-model">Fit the model</a></li>
        <li><a href="#define-the-cross-validation-pipeline">Define the cross-validation pipeline</a></li>
        <li><a href="#saving-and-loading-model">Saving and loading model</a></li>
      </ul>
    </li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="python-tools-for-data-analysis">Python Tools for Data Analysis</h1>
<h2 id="1-python-installation-anaconda">1. Python Installation: Anaconda</h2>
<p><strong>If you already have a python environment, ignore this session.</strong></p>
<p><a href="https://www.anaconda.com/">Anaconda</a> is a complete, <a href="https://docs.anaconda.com/anaconda/eula">open source</a> data science package with a community of over 6 million users. It is easy to <a href="https://www.anaconda.com/download/">download</a> and install, and it is supported on Linux, MacOS, and Windows (<a href="https://opensource.com/article/18/4/getting-started-anaconda-python">source</a>).</p>
<p>We&rsquo;ll use <a href="https://docs.conda.io/en/latest/miniconda.html">Miniconda</a> for minimal installation.</p>
<h3 id="windows-and-macos">Windows and macOS</h3>
<ol>
<li>Download the Python 3.7 distribution packages from <a href="https://docs.conda.io/en/latest/miniconda.html">this website</a>.</li>
<li>Install the package according to the instructions.</li>
<li>Start to use conda environment with <em>Anaconda Prompt</em> or other shells if you enabled this feature during installation.</li>
</ol>
<h3 id="linux-with--terminal">Linux with  terminal</h3>
<ol>
<li>
<p>Start the terminal.</p>
</li>
<li>
<p>Switch to <code>~/Download/</code> with command <code>cd ~/Download/</code>. If the path does not exist, create one using <code>mkdir ~/Download/</code>.</p>
</li>
<li>
<p>Download the latest Linux Miniconda distribution using <code>wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh</code>.</p>
</li>
<li>
<p>Install by <code>bash Miniconda3-latest-Linux-x86_64.sh</code>.</p>
</li>
<li>
<p>Follow the prompts on the installer screens.</p>
<p>If you are unsure about any setting, accept the defaults. You can change them later.</p>
</li>
<li>
<p>To make the changes take effect, close and then re-open your terminal window or use the command <code>source bashrc</code>.</p>
</li>
<li>
<p>If you are using <em>zsh</em> or other shells, make sure conda is initiated. To do this, switch back to bash and type the command <code>conda init &lt;shell name&gt;</code>.</p>
</li>
</ol>
<h3 id="check-your-installation">Check your installation</h3>
<p>You can use the command <code>conda list</code> to check your conda installation. If the terminal returns a bunch of python packages, then your installation is success.</p>
<h3 id="conda-environment">Conda environment</h3>
<p>With conda, you can create, export, list, remove, and update environments that have different versions of Python and/or packages installed in them. Switching or moving between environments is called activating the environment. You can also share an environment file.</p>
<p>This part is not necessary as you can directly use your <em>base</em> environment. However, for those who wants to know more, refer to <a href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html">this website</a> for details and instructions.</p>
<h2 id="2-package-installation">2. Package Installation</h2>
<p>If you are using anaconda, you can directly use the anaconda package manager. Otherwise, you can use other managers such as <em>pip</em>. We&rsquo;ll only demonstrate how to install packages with <code>conda</code> instructions.</p>
<p>To look for a specific package, you can visit <a href="https://anaconda.org/">this website</a> and type the name of that package in the search box. For today&rsquo;s instruction, we need to install <code>numpy</code>, <code>matplotlib</code>,  <code>scikit-learn</code> and <code>pandas</code>.</p>
<p>First, switch to your conda environment, then install those packages by typing these instructions one by one:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">conda install -c conda-forge numpy
conda install -c conda-forge matplotlib
conda install -c conda-forge scikit-learn
conda install -c conda-forge pandas
</code></pre></div><p>The package manager will automatically install all the dependencies. So if you choose to install scikit-learn first, then you  don&rsquo;t have to install numpy manually as scikit-learn depends on numpy.</p>
<p>If you prefer a fancier and more powerful python shell, you can choose to install <code>ipython</code> and even <code>jupyter notebook</code>, which allows you to run your commands in your browser.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">conda install -c conda-forge ipython
conda install jupyter
</code></pre></div><h2 id="3-basic-python-concepts">3. Basic Python Concepts</h2>
<blockquote>
<p>A more comprehensive tutorial can be found at <a href="http://cs231n.github.io/python-numpy-tutorial/#python-basic">this website</a>. In this and the following sections we&rsquo;ll just introduce the surface due to time limitation.</p>
</blockquote>
<p>First, in your terminal, type <code>python</code> or <code>ipython</code> or <code>jupyter notebook</code> to start a python shell. <code>ipython</code> or <code>jupyter notebook</code> is recommended.</p>
<h3 id="variable-definition-input-and-print">Variable definition, input and print</h3>
<p>There&rsquo;s no type constraint for a variable, i.e., a variable can be of any type.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a <span style="color:#f92672">=</span> <span style="color:#ae81ff">123</span>
b <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;123&#39;</span>
c <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;1234&#34;</span>
<span style="color:#66d9ef">print</span>(a, b, c, type(a), type(b), type(c))
</code></pre></div><p>A variable can be overwritten by different types</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a <span style="color:#f92672">=</span> <span style="color:#ae81ff">123.456</span>
<span style="color:#66d9ef">print</span>(type(a))
a <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;123&#39;</span>
<span style="color:#66d9ef">print</span>(type(a))
</code></pre></div><p>Input some strings interactively:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#39;Input something: &#39;</span>)
<span style="color:#66d9ef">print</span>(x, type(x))
</code></pre></div><h3 id="list-tuple-set-and-dictionary">List, tuple, set and dictionary</h3>
<ul>
<li><strong>List</strong> is a collection which is ordered and changeable. Allows duplicate members.</li>
<li><strong>Tuple</strong> is a collection which is ordered and unchangeable. Allows duplicate members.</li>
<li><strong>Set</strong> is a collection which is unordered and unindexed. No duplicate members.</li>
<li><strong>Dictionary</strong> is a collection which is unordered, changeable and indexed. No duplicate members.</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">_list <span style="color:#f92672">=</span> [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1.2</span>, <span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">&#39;2&#39;</span>, <span style="color:#ae81ff">1</span>]  <span style="color:#75715e"># this is a list</span>
_tuple <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1.2</span>, <span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">&#39;2&#39;</span>, <span style="color:#ae81ff">1</span>)  <span style="color:#75715e"># this is a tuple</span>
_set <span style="color:#f92672">=</span> {<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1.2</span>, <span style="color:#e6db74">&#39;1&#39;</span>, <span style="color:#e6db74">&#39;2&#39;</span>, <span style="color:#ae81ff">1</span>}  <span style="color:#75715e"># this is a set</span>
_dict <span style="color:#f92672">=</span> {  <span style="color:#75715e"># this is a dict</span>
    <span style="color:#ae81ff">1</span>: <span style="color:#e6db74">&#39;111&#39;</span>,
    <span style="color:#ae81ff">2</span>: <span style="color:#e6db74">&#39;222&#39;</span>,
    <span style="color:#e6db74">&#39;1&#39;</span>: <span style="color:#ae81ff">567</span>,
    <span style="color:#ae81ff">2.2</span>: [<span style="color:#e6db74">&#39;J&#39;</span>, <span style="color:#e6db74">&#39;Q&#39;</span>, <span style="color:#e6db74">&#39;K&#39;</span>]
}
<span style="color:#66d9ef">print</span>(_list, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, _tuple, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, _set, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, _dict)
</code></pre></div><p>Access elements</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(_list[<span style="color:#ae81ff">0</span>], _list[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>], _list[<span style="color:#ae81ff">1</span>: <span style="color:#ae81ff">3</span>])
<span style="color:#66d9ef">print</span>(_tuple[<span style="color:#ae81ff">1</span>], _tuple[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>])
<span style="color:#66d9ef">print</span>(_set[<span style="color:#ae81ff">0</span>], _set[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])  <span style="color:#75715e"># This will throw an error</span>
<span style="color:#66d9ef">print</span>(_dict[<span style="color:#ae81ff">1</span>], _dict[<span style="color:#e6db74">&#39;1&#39;</span>], _dict[<span style="color:#ae81ff">2.2</span>])
</code></pre></div><p>Shallow copy</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a <span style="color:#f92672">=</span> _list
a[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">888</span>
<span style="color:#66d9ef">print</span>(a, <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, _list)
</code></pre></div><h3 id="if-else">If else</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">if</span> <span style="color:#ae81ff">888</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> _dict<span style="color:#f92672">.</span>keys():
    _dict[<span style="color:#ae81ff">888</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;???&#39;</span>
<span style="color:#66d9ef">elif</span> <span style="color:#ae81ff">999</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> _dict<span style="color:#f92672">.</span>keys():
    _dict[<span style="color:#ae81ff">999</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;!@#$%&#39;</span>
<span style="color:#66d9ef">else</span>:
    _dict[<span style="color:#e6db74">&#39;qwert&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;poiuy&#39;</span>
</code></pre></div><h3 id="loops">Loops</h3>
<p><code>for</code> loop:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> _list:
    <span style="color:#66d9ef">print</span>(x)

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(_list)):
    <span style="color:#66d9ef">print</span>(_list[i])
</code></pre></div><p><code>while</code> loop:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">while</span> i <span style="color:#f92672">!=</span> len(_list):
    <span style="color:#66d9ef">print</span>(_list[i])
    i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</code></pre></div><h3 id="function">Function</h3>
<p>Define a function:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">my_func</span>(x):
	x <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;in function: &#39;</span>, x)
    <span style="color:#66d9ef">return</span> x
</code></pre></div><p>Call a function</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">t <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
tt <span style="color:#f92672">=</span> my_func(t)
<span style="color:#66d9ef">print</span>(f<span style="color:#e6db74">&#39;out of funciton, t: {t}, tt: {tt}&#39;</span>)
</code></pre></div><h2 id="4-basic-numpy-usage">4. Basic Numpy Usage</h2>
<h3 id="array-creation">Array creation</h3>
<p>A numpy array is a grid of values, all of the same type, and is indexed by a tuple of nonnegative integers. The number of dimensions is the <em>rank</em> of the array; the <em>shape</em> of an array is a tuple of integers giving the size of the array along each dimension.</p>
<p>We can initialize numpy arrays from nested Python lists, and access elements using square brackets:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

a <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>])   <span style="color:#75715e"># Create a rank 1 array</span>
<span style="color:#66d9ef">print</span>(type(a), a<span style="color:#f92672">.</span>dtype)
<span style="color:#66d9ef">print</span>(a<span style="color:#f92672">.</span>shape)
<span style="color:#66d9ef">print</span>(a[<span style="color:#ae81ff">1</span>])

b <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>],[<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">6</span>]])    <span style="color:#75715e"># Create a rank 2 array</span>
<span style="color:#66d9ef">print</span>(b<span style="color:#f92672">.</span>shape)
<span style="color:#66d9ef">print</span>(b[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], b[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>], b[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>])
</code></pre></div><p>Change the type of an array:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(a<span style="color:#f92672">.</span>dtype)
a <span style="color:#f92672">=</span> a<span style="color:#f92672">.</span>astype(np<span style="color:#f92672">.</span>float)
<span style="color:#66d9ef">print</span>(a<span style="color:#f92672">.</span>dtype)
</code></pre></div><p>Other array creation methods:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>zeros((<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">2</span>))   <span style="color:#75715e"># Create an array of all zeros</span>
<span style="color:#66d9ef">print</span>(a)
b <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>ones((<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>))    <span style="color:#75715e"># Create an array of all ones</span>
<span style="color:#66d9ef">print</span>(b)
c <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>full((<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">2</span>), <span style="color:#ae81ff">7</span>, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float32)  <span style="color:#75715e"># Create a constant array</span>
<span style="color:#66d9ef">print</span>(c)
d <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>eye(<span style="color:#ae81ff">3</span>)         <span style="color:#75715e"># Create a 3x3 identity matrix</span>
<span style="color:#66d9ef">print</span>(d)
e <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>random((<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">3</span>))  <span style="color:#75715e"># Create an array filled with random values</span>
<span style="color:#66d9ef">print</span>(e)
</code></pre></div><h3 id="array-indexing">Array indexing</h3>
<p>Similar to Python lists, numpy arrays can be sliced. Since arrays may be multidimensional, you must specify a slice for each dimension of the array:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">12</span>)<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>)		<span style="color:#75715e"># Create a rank 1 array and reshape it to a 3x4 matrix</span>
b <span style="color:#f92672">=</span> a[:<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">3</span>]
<span style="color:#66d9ef">print</span>(a)
<span style="color:#66d9ef">print</span>(b)

<span style="color:#75715e"># Shallow copy</span>
b[<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">888</span>
<span style="color:#66d9ef">print</span>(a)
</code></pre></div><p>You can mix integer indexing with slice indexing. However, doing so will yield an array of lower rank than the original array:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">row_r1 <span style="color:#f92672">=</span> a[<span style="color:#ae81ff">1</span>, :]    <span style="color:#75715e"># Rank 1 view of the second row of a</span>
row_r2 <span style="color:#f92672">=</span> a[<span style="color:#ae81ff">1</span>:<span style="color:#ae81ff">2</span>, :]  <span style="color:#75715e"># Rank 2 view of the second row of a</span>
<span style="color:#66d9ef">print</span>(row_r1, row_r1<span style="color:#f92672">.</span>shape)
<span style="color:#66d9ef">print</span>(row_r2, row_r2<span style="color:#f92672">.</span>shape)
</code></pre></div><p>You can also access element in the array via list:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>]
y <span style="color:#f92672">=</span> [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>]
<span style="color:#66d9ef">print</span>(a[x, y])
</code></pre></div><p>Or via boolean array:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">b <span style="color:#f92672">=</span> a <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">4</span>
<span style="color:#66d9ef">print</span>(b)
<span style="color:#66d9ef">print</span>(a[b])
</code></pre></div><h3 id="array-math">Array math</h3>
<p>Basic mathematical functions operate elementwise on arrays, and are available both as operator overloads and as functions in the numpy module:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float)<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)
y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">9</span>, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float)<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)
<span style="color:#66d9ef">print</span>(x)
<span style="color:#66d9ef">print</span>(y)

<span style="color:#75715e"># Elementwise sum</span>
<span style="color:#66d9ef">print</span>(x <span style="color:#f92672">+</span> y)
<span style="color:#66d9ef">print</span>(np<span style="color:#f92672">.</span>add(x, y))

<span style="color:#75715e"># Elementwise difference</span>
<span style="color:#66d9ef">print</span>(x <span style="color:#f92672">-</span> y)
<span style="color:#66d9ef">print</span>(np<span style="color:#f92672">.</span>subtract(x, y))

<span style="color:#75715e"># Elementwise product</span>
<span style="color:#66d9ef">print</span>(x <span style="color:#f92672">*</span> y)
<span style="color:#66d9ef">print</span>(np<span style="color:#f92672">.</span>multiply(x, y))

<span style="color:#75715e"># Elementwise division</span>
<span style="color:#66d9ef">print</span>(x <span style="color:#f92672">/</span> y)
<span style="color:#66d9ef">print</span>(np<span style="color:#f92672">.</span>divide(x, y))

<span style="color:#75715e"># Elementwise square</span>
<span style="color:#66d9ef">print</span>(x <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>)
<span style="color:#66d9ef">print</span>(np<span style="color:#f92672">.</span>power(x, <span style="color:#ae81ff">2</span>))

<span style="color:#75715e"># Elementwise square root</span>
<span style="color:#66d9ef">print</span>(x <span style="color:#f92672">**</span> <span style="color:#ae81ff">0.5</span>)
<span style="color:#66d9ef">print</span>(np<span style="color:#f92672">.</span>sqrt(x))
</code></pre></div><p>Matrix multiplication</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float)<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)
y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">9</span>, dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float)<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)
<span style="color:#66d9ef">print</span>(x)
<span style="color:#66d9ef">print</span>(y)

v <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">10</span>], dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float)
w <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>], dtype<span style="color:#f92672">=</span>np<span style="color:#f92672">.</span>float)

<span style="color:#75715e"># Inner product</span>
<span style="color:#66d9ef">print</span>(v<span style="color:#f92672">.</span>dot(w))
<span style="color:#66d9ef">print</span>(np<span style="color:#f92672">.</span>dot(v, w))
<span style="color:#66d9ef">print</span>(v <span style="color:#960050;background-color:#1e0010">@</span> w)

<span style="color:#75715e"># Matrix / vector product</span>
<span style="color:#66d9ef">print</span>(x<span style="color:#f92672">.</span>dot(v))
<span style="color:#66d9ef">print</span>(np<span style="color:#f92672">.</span>dot(x, v))
<span style="color:#66d9ef">print</span>(x <span style="color:#960050;background-color:#1e0010">@</span> v)

<span style="color:#75715e"># Matrix / matrix product</span>
<span style="color:#66d9ef">print</span>(x<span style="color:#f92672">.</span>dot(y))
<span style="color:#66d9ef">print</span>(np<span style="color:#f92672">.</span>dot(x, y))
<span style="color:#66d9ef">print</span>(x <span style="color:#960050;background-color:#1e0010">@</span> y)
</code></pre></div><p><strong>Attention:</strong> <code>np.dot()</code> and <code>@</code> behaves differently when the rank of matrix is larger than or equal to 3.</p>
<p>Numpy provides many useful functions for performing computations on arrays such as  <code>sum</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(np<span style="color:#f92672">.</span>sum(x))  <span style="color:#75715e"># Compute sum of all elements; prints &#34;10&#34;</span>
<span style="color:#66d9ef">print</span>(x<span style="color:#f92672">.</span>sum())  <span style="color:#75715e"># same as above</span>
<span style="color:#66d9ef">print</span>(np<span style="color:#f92672">.</span>sum(x, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>))  <span style="color:#75715e"># Compute sum of each column; prints &#34;[4 6]&#34;</span>
<span style="color:#66d9ef">print</span>(np<span style="color:#f92672">.</span>sum(x, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>))  <span style="color:#75715e"># Compute sum of each row; prints &#34;[3 7]&#34;</span>
</code></pre></div><p>To transpose a matrix, simply use the <code>T</code> attribute of an array object:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(x<span style="color:#f92672">.</span>T)

<span style="color:#75715e"># Note that taking the transpose of a rank 1 array does nothing:</span>
<span style="color:#66d9ef">print</span>(v)
<span style="color:#66d9ef">print</span>(v<span style="color:#f92672">.</span>T)
</code></pre></div><h2 id="5-using-matplotlib-for-visualization">5. Using Matplotlib for visualization</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#75715e"># %matplotlib qt</span>

<span style="color:#75715e"># Compute the x and y coordinates for points on a sine curve</span>
x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>pi, <span style="color:#ae81ff">0.1</span>)
y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sin(x)

<span style="color:#75715e"># Plot the points using matplotlib</span>
plt<span style="color:#f92672">.</span>plot(x, y)
plt<span style="color:#f92672">.</span>show()  <span style="color:#75715e"># You must call plt.show() to make graphics appear.</span>
</code></pre></div><p>**Note: **if you are using jupyter notebook, you can use the command <code>%matplotlib inline</code> to make the graphics embedded in the editor or <code>%matplotlib qt</code> to make them pop out.</p>
<p>To plot multiple lines at once, and add a title, legend, and axis labels:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>pi, <span style="color:#ae81ff">0.1</span>)
y_sin <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sin(x)
y_cos <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>cos(x)

<span style="color:#75715e"># Plot the points using matplotlib</span>
plt<span style="color:#f92672">.</span>plot(x, y_sin)
plt<span style="color:#f92672">.</span>plot(x, y_cos)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;x axis label&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;y axis label&#39;</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Sine and Cosine&#39;</span>)
plt<span style="color:#f92672">.</span>legend([<span style="color:#e6db74">&#39;Sine&#39;</span>, <span style="color:#e6db74">&#39;Cosine&#39;</span>])
plt<span style="color:#f92672">.</span>show()
</code></pre></div><p>You can plot different things in the same figure using the <code>subplot</code> function. Here is an example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Set up a subplot grid that has height 2 and width 1,</span>
<span style="color:#75715e"># and set the first such subplot as active.</span>
plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)

<span style="color:#75715e"># Make the first plot</span>
plt<span style="color:#f92672">.</span>plot(x, y_sin)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Sine&#39;</span>)

<span style="color:#75715e"># Set the second subplot as active, and make the second plot.</span>
plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>)
plt<span style="color:#f92672">.</span>plot(x, y_cos)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Cosine&#39;</span>)

<span style="color:#75715e"># Show the figure.</span>
plt<span style="color:#f92672">.</span>show()
</code></pre></div><h2 id="6-pandas-and-scikit-learn-for-data-science">6. Pandas and Scikit-Learn for Data Science</h2>
<p>In this section, we will look at a data science example using pandas as data management tool and scikit-learn (sklearn) as algorithm implementation. This section is modified from <a href="https://elitedatascience.com/python-machine-learning-tutorial-scikit-learn">here</a>.</p>
<h3 id="package-import">Package import</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd

<span style="color:#75715e"># automatically split the data into training and test set</span>
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
<span style="color:#f92672">from</span> sklearn <span style="color:#f92672">import</span> preprocessing

<span style="color:#75715e"># classifiers and regressors</span>
<span style="color:#f92672">from</span> sklearn.ensemble <span style="color:#f92672">import</span> RandomForestRegressor
<span style="color:#75715e"># Construct a Pipeline from the given estimators</span>
<span style="color:#f92672">from</span> sklearn.pipeline <span style="color:#f92672">import</span> make_pipeline
<span style="color:#75715e"># Exhaustive search over specified parameter values for an estimator.</span>
<span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> GridSearchCV

<span style="color:#75715e"># Training objective and evaluation metrics</span>
<span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> mean_squared_error, r2_score
<span style="color:#75715e"># For model persistence</span>
<span style="color:#75715e"># you can use `from sklearn.externals import joblib` if your sklearn version is earlier than 0.23</span>
<span style="color:#f92672">import</span> joblib
</code></pre></div><h3 id="load-data">Load data</h3>
<p>You can download the <a href="http://mlr.cs.umass.edu/ml/machine-learning-databases/wine-quality/winequality-red.csv">data</a> by clicking the link or using <code>wget</code>: <code>wget http://mlr.cs.umass.edu/ml/machine-learning-databases/wine-quality/winequality-red.csv</code> and move the file to your current folder. Then, load the <code>csv</code> data through <code>pandas</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;winequality-red.csv&#39;</span>, sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;;&#39;</span>)
</code></pre></div><p>Or, you can directly load the data through URL.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">dataset_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;http://mlr.cs.umass.edu/ml/machine-learning-databases/wine-quality/winequality-red.csv&#39;</span>
data <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(dataset_url, sep<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;;&#39;</span>)
</code></pre></div><p>You can also manipulate other data formats with <code>pandas</code>. A detailed document is <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html">here</a>.</p>
<h3 id="take-a-look-of-the-loaded-data">Take a look of the loaded data</h3>
<p>The data loaded is stored in the type of <code>pandas.core.frame.DataFrame</code></p>
<p>To give a peak of the data, we can simply use</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(data)
</code></pre></div><p>This will return a nice-looking preview of the elements in the DataFrame.</p>
<p>To view the name of the features of a DataFrame, one can use</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(data<span style="color:#f92672">.</span>keys())
</code></pre></div><p>To access one column, i.e., all instances of a feature, e.g., <code>pH</code>, one can use</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># These will return the same result</span>
<span style="color:#66d9ef">print</span>(data[<span style="color:#e6db74">&#39;pH&#39;</span>])
<span style="color:#66d9ef">print</span>(data<span style="color:#f92672">.</span>pH)
</code></pre></div><p>To access a row, you need the <code>DataFrame.iloc</code> attribute:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(data<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">10</span>])
</code></pre></div><p>We can also easily print some summary statistics:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(data<span style="color:#f92672">.</span>describe())
</code></pre></div><h3 id="split-data">Split data</h3>
<p>First, let&rsquo;s separate our target (y) feature from our input (X) features and divide the dataset into training and test sets using the <code>train_test_split</code> function:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">y <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>quality
X <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>drop(<span style="color:#e6db74">&#39;quality&#39;</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(
    X, y, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>, random_state<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, stratify<span style="color:#f92672">=</span>y
)
</code></pre></div><p>Stratify your sample by the target variable will ensure your training set looks similar to your test set, making your evaluation metrics more reliable.</p>
<h3 id="pre-processing">Pre-processing</h3>
<p>Standardization is the process of subtracting the means from each feature and then dividing by the feature standard deviations. It is a common requirement for machine learning tasks. Many algorithms assume that all features are centered around zero and have approximately the same variance.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">scaler <span style="color:#f92672">=</span> preprocessing<span style="color:#f92672">.</span>StandardScaler()<span style="color:#f92672">.</span>fit(X_train)
X_train_scaled <span style="color:#f92672">=</span> scaler<span style="color:#f92672">.</span>transform(X_train)
X_test_scaled <span style="color:#f92672">=</span> scaler<span style="color:#f92672">.</span>transform(X_test)

<span style="color:#75715e"># To prove the trainig and testing sets have (nearly) zero mean and one deviation</span>
<span style="color:#66d9ef">print</span>(X_train_scaled<span style="color:#f92672">.</span>mean(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>))
<span style="color:#66d9ef">print</span>(X_train_scaled<span style="color:#f92672">.</span>std(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>))
<span style="color:#66d9ef">print</span>(X_test_scaled<span style="color:#f92672">.</span>mean(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>))
<span style="color:#66d9ef">print</span>(X_test_scaled<span style="color:#f92672">.</span>std(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>))
</code></pre></div><h3 id="fit-the-model">Fit the model</h3>
<p>If we do not need to fine-tune the hyperparameters, we can define a random forest regression model with the default hyperparameters and fit the model using</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">regr <span style="color:#f92672">=</span> RandomForestRegressor()
regr<span style="color:#f92672">.</span>fit(X_train_scaled, y_train)
</code></pre></div><p>To examine the performance, we use the test set to calculate the scores</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pred <span style="color:#f92672">=</span> regr<span style="color:#f92672">.</span>predict(X_test_scaled)

<span style="color:#66d9ef">print</span>(r2_score(y_test, pred))
<span style="color:#66d9ef">print</span>(mean_squared_error(y_test, pred))
</code></pre></div><h3 id="define-the-cross-validation-pipeline">Define the cross-validation pipeline</h3>
<p>Fine-tuning hyperparameters is an important job in Machine Learning since a set of carefully chosen hyperparameters may greatly improve the performance of the model.</p>
<p>In practice, when we set up the cross-validation pipeline, we won&rsquo;t even need to manually fit the data. Instead, we&rsquo;ll simply declare the class object, like so:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pipeline <span style="color:#f92672">=</span> make_pipeline(
    preprocessing<span style="color:#f92672">.</span>StandardScaler(),
    RandomForestRegressor(n_estimators<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)
)
</code></pre></div><p>To check the hyperparameters, we may use</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span> pipeline<span style="color:#f92672">.</span>get_params()
</code></pre></div><p>or refer to the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html">official document</a>.</p>
<p>Now, let&rsquo;s declare the hyperparameters we want to tune through cross-validation.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">hyperparameters <span style="color:#f92672">=</span> {
    <span style="color:#e6db74">&#39;randomforestregressor__max_features&#39;</span> : [<span style="color:#e6db74">&#39;auto&#39;</span>, <span style="color:#e6db74">&#39;sqrt&#39;</span>, <span style="color:#e6db74">&#39;log2&#39;</span>],
    <span style="color:#e6db74">&#39;randomforestregressor__max_depth&#39;</span>: [None, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">1</span>]
}
</code></pre></div><p>Then, we can set a 10-fold cross validation as simple as</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">clf <span style="color:#f92672">=</span> GridSearchCV(pipeline, hyperparameters, cv<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
</code></pre></div><p>Finally, we can automatically fine-tune the model using</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">clf<span style="color:#f92672">.</span>fit(X_train, y_train)
</code></pre></div><p>After the model fitting, if we want to check the best hyperparameters, we can use</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(clf<span style="color:#f92672">.</span>best_params_)
</code></pre></div><p>Same as before, we evaluate the fitted model on test set</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pred <span style="color:#f92672">=</span> clf<span style="color:#f92672">.</span>predict(X_test)

<span style="color:#66d9ef">print</span>(r2_score(y_test, pred))
<span style="color:#66d9ef">print</span>(mean_squared_error(y_test, pred))
</code></pre></div><h3 id="saving-and-loading-model">Saving and loading model</h3>
<p>After training, we may want to save the trained model for future use. For this purpose, we can use</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">joblib<span style="color:#f92672">.</span>dump(clf, <span style="color:#e6db74">&#39;rf_regressor.pkl&#39;</span>)
</code></pre></div><p>When you want to load the model again, simply use this function:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">clf2 <span style="color:#f92672">=</span> joblib<span style="color:#f92672">.</span>load(<span style="color:#e6db74">&#39;rf_regressor.pkl&#39;</span>)
 
<span style="color:#75715e"># Predict data set using loaded model</span>
clf2<span style="color:#f92672">.</span>predict(X_test)
</code></pre></div><hr>
<p>Another more comprehensive example can be found <a href="https://scikit-learn.org/stable/tutorial/statistical_inference/index.html">here</a>.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex justify-between">





</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#1-python-installation-anaconda">1. Python Installation: Anaconda</a>
      <ul>
        <li><a href="#windows-and-macos">Windows and macOS</a></li>
        <li><a href="#linux-with--terminal">Linux with  terminal</a></li>
        <li><a href="#check-your-installation">Check your installation</a></li>
        <li><a href="#conda-environment">Conda environment</a></li>
      </ul>
    </li>
    <li><a href="#2-package-installation">2. Package Installation</a></li>
    <li><a href="#3-basic-python-concepts">3. Basic Python Concepts</a>
      <ul>
        <li><a href="#variable-definition-input-and-print">Variable definition, input and print</a></li>
        <li><a href="#list-tuple-set-and-dictionary">List, tuple, set and dictionary</a></li>
        <li><a href="#if-else">If else</a></li>
        <li><a href="#loops">Loops</a></li>
        <li><a href="#function">Function</a></li>
      </ul>
    </li>
    <li><a href="#4-basic-numpy-usage">4. Basic Numpy Usage</a>
      <ul>
        <li><a href="#array-creation">Array creation</a></li>
        <li><a href="#array-indexing">Array indexing</a></li>
        <li><a href="#array-math">Array math</a></li>
      </ul>
    </li>
    <li><a href="#5-using-matplotlib-for-visualization">5. Using Matplotlib for visualization</a></li>
    <li><a href="#6-pandas-and-scikit-learn-for-data-science">6. Pandas and Scikit-Learn for Data Science</a>
      <ul>
        <li><a href="#package-import">Package import</a></li>
        <li><a href="#load-data">Load data</a></li>
        <li><a href="#take-a-look-of-the-loaded-data">Take a look of the loaded data</a></li>
        <li><a href="#split-data">Split data</a></li>
        <li><a href="#pre-processing">Pre-processing</a></li>
        <li><a href="#fit-the-model">Fit the model</a></li>
        <li><a href="#define-the-cross-validation-pipeline">Define the cross-validation pipeline</a></li>
        <li><a href="#saving-and-loading-model">Saving and loading model</a></li>
      </ul>
    </li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












