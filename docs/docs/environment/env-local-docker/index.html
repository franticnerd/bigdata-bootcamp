<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="For the purpose of the environment normalization, we provide a simple docker image for you, which contains most of the software required by this course. We also provide a few scripts to install some optional packages. The whole progress would seem as follow:
Make sure you have enough resources: It requires at least 8GB of Physical RAM; 16GB or larger would be better It requires at least 15GB of hard disk storage Install a docker environment in the local machine Start Docker Service, pull images, and create an instance Just rock it!"><meta property="og:title" content="Docker in Local OS" />
<meta property="og:description" content="For the purpose of the environment normalization, we provide a simple docker image for you, which contains most of the software required by this course. We also provide a few scripts to install some optional packages. The whole progress would seem as follow:
Make sure you have enough resources: It requires at least 8GB of Physical RAM; 16GB or larger would be better It requires at least 15GB of hard disk storage Install a docker environment in the local machine Start Docker Service, pull images, and create an instance Just rock it!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://franticnerd/bigdata-bootcamp/docs/environment/env-local-docker/" /><meta property="article:section" content="docs" />
<meta property="article:published_time" content="2022-02-26T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-02-26T00:00:00+00:00" />
<title>Docker in Local OS | GT Big Data Bootcamp</title>
<link rel="icon" href="/bigdata-bootcamp/favicon.png" type="image/x-icon">


<link rel="stylesheet" href="/bigdata-bootcamp/book.min.43ea4026a52be03f709fccca49769e06471f235a1fc425b2a481cc2c3ea0a7d2.css" integrity="sha256-Q&#43;pAJqUr4D9wn8zKSXaeBkcfI1ofxCWypIHMLD6gp9I=">


<script defer src="/bigdata-bootcamp/en.search.min.69457d888b8306027a859bd2e2f2a630d5eadb465c5218db9abf058a5e15e0ad.js" integrity="sha256-aUV9iIuDBgJ6hZvS4vKmMNXq20ZcUhjbmr8Fil4V4K0="></script>

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/bigdata-bootcamp"><span>GT Big Data Bootcamp</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  

  
  





 
  
    




  
  <ul>
    
      
        

  <li class="book-section-flat" >
    

  
  <span>Environment</span>
  


    




  
  <ul>
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-local-docker/" class="active">Docker in Local OS</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-local-docker-linux/" class="">Install Docker in Linux</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-local-docker-macos/" class="">Install Docker in macOS</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-local-docker-windows/" class="">Install Docker in Mircosoft Windows</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/environment/env-azure-docker/" class="">Env Azure Docker</a>
  

</li>
      
    
  </ul>
  



  </li>


      
    
      
        

  <li class="book-section-flat" >
    

  
  <span>Sessions</span>
  


    




  
  <ul>
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/python-for-data-analysis/" class="">Python Tools for Data Analysis</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/scala-basic/" class="">Scala Basic</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/scala-intro/" class="">Scala Intro</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-application/" class="">Spark Application</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-basic/" class="">Spark Basic</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-graphx/" class="">Spark Graphx</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-mllib/" class="">Spark Mllib</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/spark-sql/" class="">Spark SQL</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/zeppelin-intro/" class="">Zeppelin Intro</a>
  

</li>
      
    
      
        <li>

  
  <a href="/bigdata-bootcamp/docs/sessions/zeppelin-tutorial/" class="">Zeppelin Tutorial</a>
  

</li>
      
    
  </ul>
  



  </li>


      
    
  </ul>
  



  
















</nav>




  <script>(function(){var e=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/bigdata-bootcamp/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Docker in Local OS</strong>

  <label for="toc-control">
    <img src="/bigdata-bootcamp/svg/toc.svg" class="book-icon" alt="Table of Contents" />
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#0-system-requirements">0. System requirements</a></li>
    <li><a href="#1-install-docker">1. Install Docker</a></li>
    <li><a href="#2-run-docker-image">2. Run Docker image</a>
      <ul>
        <li><a href="#21-start-the-container">2.1. Start the container</a></li>
        <li><a href="#22-start-all-necessary-services">2.2. Start all necessary services</a></li>
        <li><a href="#23-stop-all-services">2.3. Stop all services</a></li>
        <li><a href="#24-detach-or-exit">2.4. Detach or Exit</a></li>
        <li><a href="#25-re-attach">2.5. Re-attach</a></li>
        <li><a href="#26-destroy-instance">2.6. Destroy instance</a></li>
        <li><a href="#27-destroy-images">2.7. Destroy images</a></li>
        <li><a href="#28-update-images">2.8. Update images</a></li>
        <li><a href="#29-official-documentations">2.9. Official documentations</a></li>
        <li><a href="#210-optional-use-docker-compose">2.10. Optional: use docker-compose</a></li>
      </ul>
    </li>
    <li><a href="#3-configurations-and-logs">3. Configurations and logs</a>
      <ul>
        <li><a href="#31-system-configurations">3.1. System Configurations</a></li>
        <li><a href="#32-logs">3.2. Logs</a></li>
      </ul>
    </li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      
      
  <article class="markdown"><blockquote class="book-hint info">
  For the purpose of the environment normalization, we provide a simple <a href="https://docs.docker.com/">docker</a> image for you, which contains most of the software required by this course. We also provide a few scripts to install some optional packages.
</blockquote>

<p>The whole progress would seem as follow:</p>
<ol>
<li><strong>Make sure you have enough resources</strong>:
<ul>
<li>It requires at least 8GB of Physical RAM; 16GB or larger would be better</li>
<li>It requires at least 15GB of hard disk storage</li>
</ul>
</li>
<li>Install a docker environment in the local machine</li>
<li>Start Docker Service, pull images, and create an instance</li>
<li>Just rock it!</li>
<li>Destroy the containers and images if they are no longer needed</li>
</ol>
<blockquote class="book-hint warning">
  <p>Since this docker image integrated many related services for the course, it requires at least 4GB RAM for this virtual machine.
If you can not meet the minimum requirement, the system could randomly kill one or a few processes due to resource limitation, which causes a lot of strange errors which is even unable to reproduce.</p>
<p><strong>DO NOT TRY TO DO THAT.</strong><br>
Instead, you can use cloud platforms such as <a href="/env/env-azure-docker.html">Azure</a>.</p>

</blockquote>

<h2 id="0-system-requirements">0. System requirements</h2>
<p>You should have enough system resources if you plan to start a container in your local OS.</p>
<p>You need to reserve at least 4 GB RAM for Docker and some extra memory for the host machine.
However, you can still start all the Hadoop-related services except <a href="https://zeppelin.apache.org">Zeppelin</a>, even if you only reserve 4GB for the virtual machine.</p>
<h2 id="1-install-docker">1. Install Docker</h2>
<p>Docker is a software providing operating-system-level virtualization, also known as containers, promoted by the company <a href="docker.com">Docker, Inc.</a>.
Docker uses the resource isolation features of the Linux kernel such as cgroups and kernel namespaces, and a union-capable file system such as OverlayFS and others to allow independent &ldquo;containers&rdquo; to run within a single Linux instance, avoiding the overhead of starting and maintaining virtual machines (VMs).
(from <a href="https://en.wikipedia.org/wiki/Docker_%28software%29">Wikipedia</a>)
Basically, you can treat docker as a lightweight virtual machine with pretty high performance.</p>
<p>The installation instructions for different operating systems are provided in the links below.
You can also check the official documentation <a href="https://docs.docker.com/engine/installation/">here</a> to get the latest news and detailed explanations.</p>
<ul>
<li><a href="/environment/env-local-docker-linux.html">Install Docker In Linux</a></li>
<li><a href="/environment/env-local-docker-macos.html">Install Docker In macOS</a></li>
<li><a href="/environment/env-local-docker-windows.html">Install Docker In Microsoft Windows</a></li>
</ul>
<p>Once the docker is installed, you can start your docker services and launch your docker container using the following commands:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker  <span style="color:#75715e"># a tool to control docker</span>
</span></span><span style="display:flex;"><span>docker-machine  <span style="color:#75715e"># a tool that lets you install Docker Engine on virtual hosts and manage the hosts in remote</span>
</span></span><span style="display:flex;"><span>docker-compose  <span style="color:#75715e"># a tool for defining and running multi-container Docker applications</span>
</span></span></code></pre></div><p>If we use VirtualBox + Windows/macOS, the theory is pretty clear: we created a Linux instance in &ldquo;virtual remote&rdquo;, and control it using docker-machine.
If we want to operate the &ldquo;remote docker service&rdquo;, we need to prepare a set of environment variables so that we do not have to use the <code>eval $(docker-machine env default)</code> command to access its location every time.
We can list it using the command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-machine env default
</span></span></code></pre></div><blockquote class="book-hint warning">
  <p>Command <code>docker-machine</code> has been removed from the later versions of Docker Desktop.
If you still want to use the command, you can follow the directions <a href="https://stackoverflow.com/questions/60078434/docker-machine-command-not-found">here</a> and manually install the corresponding packages.</p>
<p>However, we will not rely on this command in our tutorial and its installation is <em>not required</em>.</p>

</blockquote>

<blockquote class="book-hint info">
  <p>If you are using docker-machine, you cannot reach the port from virtual machine using ip address <code>127.0.0.1</code> (<code>localhost</code>).
As an alternative, you can extract the IP using this command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ printenv  | grep <span style="color:#e6db74">&#34;DOCKER_HOST&#34;</span>
</span></span><span style="display:flex;"><span>DOCKER_HOST<span style="color:#f92672">=</span>tcp://192.168.99.100:2376
</span></span></code></pre></div><p>And visit <code>192.168.99.100</code> instead of <code>127.0.0.1</code> to access the network stream from the virtual machine.</p>

</blockquote>

<p>If these environments are not settled, docker will try to connect to the default Unix socket file.
As a Docker.app user, the file is:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ls -alh /var/run/docker.sock
</span></span><span style="display:flex;"><span>lrwxr-xr-x  <span style="color:#ae81ff">1</span> root  daemon    55B Feb <span style="color:#ae81ff">10</span> 19:09 /var/run/docker.sock -&gt; /Users/yu/Library/Containers/com.docker.docker/Data/s60
</span></span><span style="display:flex;"><span>$ ls -al /Users/yu/Library/Containers/com.docker.docker/Data/s60
</span></span><span style="display:flex;"><span>srwxr-xr-x  <span style="color:#ae81ff">1</span> yu  staff  <span style="color:#ae81ff">0</span> Feb <span style="color:#ae81ff">10</span> 19:09 /Users/yu/Library/Containers/com.docker.docker/Data/s60
</span></span></code></pre></div><p>As a Linux user, the location is slightly different:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ls -al /var/run/docker.sock
</span></span><span style="display:flex;"><span>srw-rw---- <span style="color:#ae81ff">1</span> root root <span style="color:#ae81ff">0</span> Feb <span style="color:#ae81ff">11</span> 11:35 /var/run/docker.sock
</span></span></code></pre></div><blockquote class="book-hint info">
  A Linux user <strong>must</strong> add a &ldquo;sudo&rdquo; before command <code>docker</code> since he has no access to <code>docker.sock</code> as an ordinary user.
</blockquote>

<h2 id="2-run-docker-image">2. Run Docker image</h2>
<h3 id="21-start-the-container">2.1. Start the container</h3>
<p>The command to start the container used in the following tutorials is:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker run -it --privileged<span style="color:#f92672">=</span>true <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --cap-add<span style="color:#f92672">=</span>SYS_ADMIN <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -m 8192m -h bootcamp.local <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  --name bigbox -p 2222:22 -p 9530:9530 -p 8888:8888<span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -v /:/mnt/host <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  sunlab/bigbox:latest <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  /bin/bash
</span></span></code></pre></div><p>It may take a while for the system to download and extract the container.</p>
<p>In general, the syntax of <code>docker run</code> is</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker run <span style="color:#f92672">[</span>options<span style="color:#f92672">]</span> image<span style="color:#f92672">[</span>:tag|@digest<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>command<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>args<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>Below explains the options used above:</p>
<blockquote class="book-hint info">
  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>-p &lt;host-port&gt;:&lt;vm-port&gt;
</span></span></code></pre></div><p>This option is used to map the TCP port <code>vm-port</code> in the container to port <code>host-port</code> on the Docker host.
Currently, the ports are reserved to:</p>
<ul>
<li>8888 - Jupyter Notebook</li>
<li>9530 - Zeppelin Notebook</li>
</ul>
<p>Once you have started the Zeppelin service, this service will keep listening port <code>9530</code> in docker.
You will be able to visit this service using <code>http://127.0.0.1:9530</code> or <code>http://DOCKER_HOST_IP:9530</code>.
The remote IP depends on the Docker Service you are running, which is described above.</p>
<ul>
<li>If you are using Linux or Docker.app in macOS, you can visit &ldquo;localhost:9530&rdquo;, or other ports if you changed <code>host-port</code></li>
<li>If you are using VirtualBox + macOS or Windows, you should get the Docker&rsquo;s IP first</li>
</ul>

</blockquote>

<blockquote class="book-hint info">
  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>-v, --volume<span style="color:#f92672">=[</span>host-src:<span style="color:#f92672">]</span>container-dest<span style="color:#f92672">[</span>:&lt;options&gt;<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>This option is used to mount a volume.
Currently, we are using <code>-v /:/mnt/host</code>.
In this case, we can visit the root of your file system for your host machine.
If you are using macOS, <code>/mnt/host/Users/&lt;yourname&gt;/</code> would be the <code>$HOME</code> of your MacBook.
If you are using Windows, you can reach your <code>C:</code> disk from <code>/mnt/host/c</code> in docker.</p>
<p>Variable <code>host-src</code> accepts absolute path only.</p>

</blockquote>

<blockquote class="book-hint info">
  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>-it
</span></span></code></pre></div><ul>
<li>-i              : Keep STDIN open even if not attached</li>
<li>-t              : Allocate a pseudo-tty</li>
</ul>

</blockquote>

<blockquote class="book-hint info">
  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>-h bootcamp.local
</span></span></code></pre></div><p>Once you enter this docker environment, you can ping this docker environment itself as <code>bootcamp.local</code>. This variable is used in some configuration files for Hadoop ecosystems.</p>

</blockquote>

<blockquote class="book-hint info">
  <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>-m 8192m
</span></span></code></pre></div><p>Memory limit (format: <code>&lt;number&gt;[&lt;unit&gt;]</code>).
The number should be a positive integer.
The unit can be one of <code>b</code>, <code>k</code>, <code>m</code>, or <code>g</code>.</p>
<p>This docker image requires at least 4G of RAM, while 8G is recommended when your physical machine has more than 8G of RAM.</p>
<p>The local machine is not the same as the remote server.
If you are launching a remote server with 8G RAM, you can set this number as 7G.</p>

</blockquote>

<p>Please refer to the <a href="https://docs.docker.com/engine/reference/run/">official documentation</a> for more information and the detailed explanations.</p>
<h3 id="22-start-all-necessary-services">2.2. Start all necessary services</h3>
<blockquote class="book-hint info">
  <p>In your terminal, you will generally meet two kinds of prompts.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@bootcamp /<span style="color:#f92672">]</span><span style="color:#75715e"># whoami  # this prompt &#39;#&#39; indices you are root aka the administrator of this environment now</span>
</span></span><span style="display:flex;"><span>root
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>yu@bootcamp /<span style="color:#f92672">]</span>$ whoami  <span style="color:#75715e"># this prompt &#39;$&#39; indices you are an ordinary user now</span>
</span></span><span style="display:flex;"><span>yu
</span></span></code></pre></div><p>You are in the <code>sudo</code> mode by default.
We also assume that you are always in the <code>sudo</code> mode in the following discussions.</p>

</blockquote>

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/scripts/start-services.sh
</span></span></code></pre></div><p>This script helps you to start the necessary services for the Hadoop ecosystems.</p>
<blockquote class="book-hint warning">
  You probably will encounter the &ldquo;Connection Refused&rdquo; exception if you forget to start these services.
</blockquote>

<p>If you wish to host Zeppelin, you need to install it first by using the command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/scripts/install-zeppelin.sh
</span></span></code></pre></div><p>And start the service with the command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/scripts/start-zeppelin.sh
</span></span></code></pre></div><p>Then, Zeppelin will listen to the port <code>9530</code>
Please refer to the <a href="%7b%7bbase_path%7d%7d/teaching/003-bigdata-bootcamp-zeppelin">Zeppelin tutorial</a> for more information about the configuration and usage of Zeppelin Notebook.</p>
<p>If you wish to host Jupyter, you can start it by using the command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/scripts/start-jupyter.sh
</span></span></code></pre></div><p>Jupyter will listen to the port <code>8888</code></p>
<h3 id="23-stop-all-services">2.3. Stop all services</h3>
<p>You can stop the running services with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/scripts/stop-services.sh
</span></span></code></pre></div><h3 id="24-detach-or-exit">2.4. Detach or Exit</h3>
<p>To detach and suspend a Docker instance from the terminal, use the command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ctrl + p, ctrl + q
</span></span></code></pre></div><p>To exit,</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>exit
</span></span></code></pre></div><h3 id="25-re-attach">2.5. Re-attach</h3>
<p>If you detached an instance and want to re-attach it, you need to check the <code>CONTAINER ID</code> or <code>NAMES</code> of it first.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker ps -a
</span></span><span style="display:flex;"><span>CONTAINER ID        IMAGE                  COMMAND                CREATED             STATUS              PORTS                                                                  NAMES
</span></span><span style="display:flex;"><span>011547e95ef5        sunlab/bigbox:latest   <span style="color:#e6db74">&#34;/tini -- /bin/bash&#34;</span>   <span style="color:#ae81ff">6</span> hours ago         Up <span style="color:#ae81ff">4</span> seconds        0.0.0.0:8888-&gt;8888/tcp, 0.0.0.0:9530-&gt;9530/tcp, 0.0.0.0:2222-&gt;22/tcp   bigbox
</span></span></code></pre></div><p>If the &ldquo;STATUS&rdquo; column is similar to &ldquo;Exited (0) 10 hours ago&rdquo;, you can restart the container:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker start &lt;CONTAINER ID or NAMES&gt;
</span></span></code></pre></div><p>And attach it with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker attach &lt;CONTAINER ID or NAMES&gt;
</span></span></code></pre></div><p>Every time you restart your container, you need to re-start the services (section 2.2) before any HDFS related operations.</p>
<h3 id="26-destroy-instance">2.6. Destroy instance</h3>
<p>If you want to permanently remove the container:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker rm &lt;CONTAINER ID or NAMES&gt;
</span></span></code></pre></div><h3 id="27-destroy-images">2.7. Destroy images</h3>
<p>If you want to permanently remove any images, you need to list images first:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker images
</span></span><span style="display:flex;"><span>REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
</span></span><span style="display:flex;"><span>sunlab/bigbox       latest              bfd258e00de3        <span style="color:#ae81ff">16</span> hours ago        2.65GB
</span></span></code></pre></div><p>And remove them by REPOSITORY or IMAGE ID using the command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker rmi &lt;REPOSITORY or IMAGE ID&gt;
</span></span></code></pre></div><h3 id="28-update-images">2.8. Update images</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker pull sunlab/bigbox
</span></span></code></pre></div><h3 id="29-official-documentations">2.9. Official documentations</h3>
<p>Please refer to <a href="https://docs.docker.com/v17.09/engine/userguide/storagedriver/imagesandcontainers/">this link</a> for the introduction of images, containers, and storage drivers.</p>
<h3 id="210-optional-use-docker-compose">2.10. Optional: use docker-compose</h3>
<p><a href="https://docs.docker.com/compose/">Docker Compose</a> is a tool for defining and running multi-container Docker applications.
A simple <code>docker-compose.yml</code> could <em>simplify</em> the parameters and make your life easier.</p>
<p>Please refer to <a href="/env/env-docker-compose.html#docker-compose">this page</a> for further instructions.</p>
<h2 id="3-configurations-and-logs">3. Configurations and logs</h2>
<h3 id="31-system-configurations">3.1. System Configurations</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cat /proc/meminfo  | grep Mem <span style="color:#75715e">## Current Memory</span>
</span></span><span style="display:flex;"><span>MemTotal:        <span style="color:#ae81ff">8164680</span> kB <span style="color:#75715e">## Note: This value shoud no less than 4GB</span>
</span></span><span style="display:flex;"><span>MemFree:          <span style="color:#ae81ff">175524</span> kB
</span></span><span style="display:flex;"><span>MemAvailable:    <span style="color:#ae81ff">5113340</span> kB
</span></span><span style="display:flex;"><span>$ cat /proc/cpuinfo  | grep <span style="color:#e6db74">&#39;model name&#39;</span> | head -1  <span style="color:#75715e">## CPU Brand</span>
</span></span><span style="display:flex;"><span>model name	: Intel<span style="color:#f92672">(</span>R<span style="color:#f92672">)</span> Core<span style="color:#f92672">(</span>TM<span style="color:#f92672">)</span> i7-7920HQ CPU @ 3.10GHz
</span></span><span style="display:flex;"><span>$ cat /proc/cpuinfo  | grep <span style="color:#e6db74">&#39;model name&#39;</span> | wc -l <span style="color:#75715e">## CPU Count</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>$ df -h <span style="color:#75715e">## List Current Hard Disk Usage</span>
</span></span><span style="display:flex;"><span>Filesystem      Size  Used Avail Use% Mounted on
</span></span><span style="display:flex;"><span>overlay          32G  4.6G   26G  16% /
</span></span><span style="display:flex;"><span>tmpfs            64M     <span style="color:#ae81ff">0</span>   64M   0% /dev
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>$ ps -ef <span style="color:#75715e">## List Current Running Process</span>
</span></span><span style="display:flex;"><span>UID        PID  PPID  C STIME TTY          TIME CMD
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">1</span>     <span style="color:#ae81ff">0</span>  <span style="color:#ae81ff">0</span> 01:38 pts/0    00:00:00 /tini -- /bin/bash
</span></span><span style="display:flex;"><span>root         <span style="color:#ae81ff">7</span>     <span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">0</span> 01:38 pts/0    00:00:00 /bin/bash
</span></span><span style="display:flex;"><span>root        <span style="color:#ae81ff">77</span>     <span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">0</span> 01:43 ?        00:00:00 /usr/sbin/sshd
</span></span><span style="display:flex;"><span>zookeep+   <span style="color:#ae81ff">136</span>     <span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">0</span> 01:43 ?        00:00:14 /usr/lib/jvm/java-openjdk/bin/java -Dzookeeper.log.dir<span style="color:#f92672">=</span>/var/log/zookeeper -Dzookeeper.root.logger<span style="color:#f92672">=</span>INFO,ROLLINGFILE -cp /usr/lib/zookeeper/bin/../build/classes:/
</span></span><span style="display:flex;"><span>yarn       <span style="color:#ae81ff">225</span>     <span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">0</span> 01:43 ?        00:00:13 /usr/lib/jvm/java/bin/java -Dproc_proxyserver -Xmx1000m -Dhadoop.log.dir<span style="color:#f92672">=</span>/var/log/hadoop-yarn -Dyarn.log.dir<span style="color:#f92672">=</span>/var/log/hadoop-yarn -Dhadoop.log.file<span style="color:#f92672">=</span>yarn-yarn-pr
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>$ lsof -i:9530 <span style="color:#75715e">## Find the Process Listening to Some Specific Port</span>
</span></span><span style="display:flex;"><span>COMMAND  PID     USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
</span></span><span style="display:flex;"><span>java    <span style="color:#ae81ff">3165</span> zeppelin  189u  IPv4 <span style="color:#ae81ff">229945</span>      0t0  TCP *:9530 <span style="color:#f92672">(</span>LISTEN<span style="color:#f92672">)</span>
</span></span></code></pre></div><h3 id="32-logs">3.2. Logs</h3>
<ul>
<li><strong>hadoop-hdfs</strong> &ndash; /var/log/hadoop-hdfs/*</li>
<li><strong>hadoop-mapreduce</strong>  &ndash; /var/log/hadoop-mapreduce/*</li>
<li><strong>hadoop-yarn</strong> &ndash; /var/log/hadoop-yarn/*</li>
<li><strong>hbase</strong>  &ndash;  /var/log/hbase/*</li>
<li><strong>hive</strong>  &ndash; /var/log/hive/*</li>
<li><strong>spark</strong>  &ndash; /var/log/spark/*</li>
<li><strong>zookeeper</strong> &ndash; /var/log/zookeeper/*</li>
<li><strong>zeppelin</strong> &ndash; /usr/local/zeppelin/logs/*</li>
</ul>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex justify-between">





</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#0-system-requirements">0. System requirements</a></li>
    <li><a href="#1-install-docker">1. Install Docker</a></li>
    <li><a href="#2-run-docker-image">2. Run Docker image</a>
      <ul>
        <li><a href="#21-start-the-container">2.1. Start the container</a></li>
        <li><a href="#22-start-all-necessary-services">2.2. Start all necessary services</a></li>
        <li><a href="#23-stop-all-services">2.3. Stop all services</a></li>
        <li><a href="#24-detach-or-exit">2.4. Detach or Exit</a></li>
        <li><a href="#25-re-attach">2.5. Re-attach</a></li>
        <li><a href="#26-destroy-instance">2.6. Destroy instance</a></li>
        <li><a href="#27-destroy-images">2.7. Destroy images</a></li>
        <li><a href="#28-update-images">2.8. Update images</a></li>
        <li><a href="#29-official-documentations">2.9. Official documentations</a></li>
        <li><a href="#210-optional-use-docker-compose">2.10. Optional: use docker-compose</a></li>
      </ul>
    </li>
    <li><a href="#3-configurations-and-logs">3. Configurations and logs</a>
      <ul>
        <li><a href="#31-system-configurations">3.1. System Configurations</a></li>
        <li><a href="#32-logs">3.2. Logs</a></li>
      </ul>
    </li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












